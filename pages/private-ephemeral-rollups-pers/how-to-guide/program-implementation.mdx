---
title: "Program Implementation"
description: "Enable privacy in any Solana program state account through MagicBlock's ER and Trusted Execution Environment on Intel TDX."
---

import PerCards from "/snippets/per-cards.mdx";
import QuickAccessPER from "/snippets/quick-access-per.mdx";

import CreateRustCode from "/snippets/per-rust-code/create.mdx";
import DelegateRustCode from "/snippets/per-rust-code/delegate.mdx";
import UpdateRustCode from "/snippets/per-rust-code/update.mdx";
import UndelegateRustCode from "/snippets/per-rust-code/commit-and-undelegate.mdx";
import CloseRustCode from "/snippets/per-rust-code/close.mdx";

---

<QuickAccessPER />

---

### Program Implementation Flow

Writing programs for the MagicBlock TEE is similar to writing a standard Solana program, with the addition of a Permission Program used to manage your access control list.

- **Permissions**: Manage permission for any state account. Define permission and set members with fine-grained permission flags to set their specific program, transaction and account access for permissioned accounts.
- **Access**: Clients authenticate their identity to access permissioned ER state. If successful, an access token is issued and used for queries.

### Code Snippets

<Tabs>
  <Tab title="1. Create">
    Create permission for account through CPI call to Permission Program:
    <CreateRustCode />
    [⬆️ Back to Top](#code-snippets)
  </Tab>
  <Tab title="2. Delegate">
    Delegate permission and permissioned account to enforce privacy:
    <DelegateRustCode />
    [⬆️ Back to Top](#code-snippets)
  </Tab>
  <Tab title="3. Update">
    Make permissioned account visible in PER:
    <UpdateRustCode />
    [⬆️ Back to Top](#code-snippets)
  </Tab>
  <Tab title="4. Undelegate">
    Commit and undelegate permissions to Solana:
    <UndelegateRustCode />
    [⬆️ Back to Top](#code-snippets)
  </Tab>
  <Tab title="5. Close">
    Close permission to receive deposit back:
    <CloseRustCode />
    [⬆️ Back to Top](#code-snippets)
  </Tab>
</Tabs>

import PerEndpoint from "/snippets/per-endpoint.mdx";

<PerEndpoint />

---

<PerCards />
